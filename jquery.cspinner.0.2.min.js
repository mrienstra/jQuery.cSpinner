/*!
 * jQuery Canvas Spinner Plugin v0.2
 * https://github.com/mrienstra/jQuery.cSpinner
 *
 * Copyright 2011, Michael Rienstra
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Based on code by Thijs van der Vossen, Fingertips, http://www.fngtps.com
 *
 * Replaces the target element(s) with canvas elements (unless they are already canvas elements), then draws an animated loading indicator
 *
 * Date: Tue Jun 7 4:57:11 2011 -0700
 */
(function(g){var u=function(){var d=document.createElement("canvas");return!(!d.getContext||!d.getContext("2d"))},m={init:function(d){var j=this;if(!u)return console.log("jQuery.cSpinner: Canvas not supported"),this;this.each(function(m){var a={scale:1,width:3,inner:8.7,outer:14.42,color:"#000",segments:12,speed:1,shadow:!1,shadowOffsetX:1,shadowOffsetY:1,shadowBlur:1,shadowColor:"rgba(10, 10, 10, 0.5)",checkExistsInterval:1E3,preserveExisting:["id","class","style"]},n=g(this),e,b,r,o,h,i,f,c,k,l=[],p=[],q,s=0,t;d&&g.extend(a,d);a.width*=a.scale;a.inner*=a.scale;a.outer*=a.scale;a.delay=1E3/a.speed/a.segments;a.center=Math.ceil(a.outer+a.width);a.canvasSize=a.center*2;if(window.devicePixelRatio&&window.devicePixelRatio!==1)a.canvasSizeCSS=a.canvasSize+"px",a.canvasSize*=window.devicePixelRatio;this.nodeName!=="CANVAS"?(e=g("<canvas />"),n.replaceWith(function(){b=0;for(r=a.preserveExisting.length;b<r;b++)o=a.preserveExisting[b],n.attr(o)&&e.attr(o,n.attr(o));return e}),e=e[0],h=g(e)):(e=this,h=n);i=h.attr("id");i===""?(f="cSpinner"+String(Math.random()).substring(2),h.attr("id",f),f="#"+f):g("#"+i).length!==1?(f="cSpinner"+String(Math.random()).substring(2),h.addClass(f),f="."+f):f="#"+i;e.width=e.height=a.canvasSize;c=e.getContext("2d");c.lineWidth=a.width;c.lineCap="round";c.strokeStyle=a.color;if(a.shadow)c.shadowOffsetX=a.shadowOffsetX*a.scale,c.shadowOffsetY=a.shadowOffsetY*a.scale,c.shadowBlur=a.shadowBlur*a.scale,c.shadowColor=a.shadowColor;window.devicePixelRatio&&window.devicePixelRatio!==1&&(c.scale(window.devicePixelRatio,window.devicePixelRatio),h.css({width:a.canvasSizeCSS,height:a.canvasSizeCSS}));for(b=0;b<a.segments;b++)k=2*Math.PI/a.segments*b-Math.PI/2,i=Math.cos(k),k=Math.sin(k),l[b]=[a.inner*i,a.inner*k,a.outer*i,a.outer*k],p[b]=Math.pow(b/(a.segments-1),1.8)*(1-0.18)+0.18;s=0;t=Math.round(a.checkExistsInterval/a.delay);q=setInterval(function(){c.clearRect(0,0,e.width,e.height);p.unshift(p.pop());for(b=0;b<a.segments;b++)c.globalAlpha=p[b],c.beginPath(),c.moveTo(a.center+l[b][0],a.center+l[b][1]),c.lineTo(a.center+l[b][2],a.center+l[b][3]),c.stroke();s++%t===0&&g(f).length!==1&&clearInterval(q)},a.delay);h.data("cSpinner",{intervalID:q});e!==this&&(j[m]=e)});return j},stop:function(){return this.each(function(){var d=g(this),j=d.data("cSpinner");j&&j.intervalID&&(clearInterval(j.intervalID),d.removeData("cSpinner"))})}};g.fn.cSpinner=function(d){if(m[d])return m[d].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof d==="object"||!d)return m.init.apply(this,arguments);else g.error("jQuery.cSpinner: Method \u201c"+d+"\u201d does not exist")}})(jQuery);