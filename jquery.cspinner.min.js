/*!
 * jQuery.cSpinner, v0.2.6
 * https://github.com/mrienstra/jQuery.cSpinner
 *
 * Copyright 2011, Michael Rienstra
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Based on code by Thijs van der Vossen, Fingertips, http://www.fngtps.com
 *
 * A jQuery plugin to create animated loading indicators using the canvas element
 *
 * Date: Thu Jul 7, 2011
 */
(function(e){var H="cSpinner",i={init:function(d){var a=this,f=function(){var a=document.createElement("canvas");if(a.getContext&&a.getContext("2d"))return a.toDataURL("image/png").indexOf("data:image/png")===0?"f":"p";return"n"}();this.each(function(G){var b={speed:1,scale:1,lineWidth:3,lineCap:"round",innerRadius:8.7,outerRadius:14.42,color:"#000",minimumOpacity:0.18,segments:12,shadow:!1,shadowOffsetX:1,shadowOffsetY:1,shadowBlur:1,shadowColor:"rgba(10, 10, 10, 0.5)",pixelRatio:1,autoStart:!0,pauseOnBlur:!0,
alwaysReplaceTarget:!1,fallbackSourcesArray:void 0,checkExistsInterval:1E3,preserveExisting:["id","class","style"]},c,w,s=["lineWidth","innerRadius","outerRadius","shadowOffsetX","shadowOffsetY","shadowBlur"],j,i,m,n,u,x,h,o,k,v="<canvas /><canvas />",A=e(this),B,l,C,t,y,p,E,g,q=[],z=[],D=[],r=0,F;d&&e.extend(b,d);if(f==="n")if(typeof b.fallbackSourcesArray==="undefined")return!0;else v="";h=b.pixelRatio;h!==1&&(b.scale*=h);c=0;for(w=s.length;c<w;c+=1)b[s[c]]*=b.scale;j=b.segments;i=1E3/b.speed/
j;s=b.outerRadius;m=s+b.lineWidth;if(b.shadow)n=b.shadowOffsetX,u=b.shadowOffsetY,m+=n>u?n:u,m+=b.shadowBlur;m=Math.ceil(m);x=o=m*2;h!==1&&(o/=h);b.alwaysReplaceTarget===!0||this.nodeName!=="DIV"?(k=e("<div>"+v+"</div>"),A.replaceWith(function(){c=0;for(w=b.preserveExisting.length;c<w;c+=1)B=b.preserveExisting[c],A.attr(B)&&k.attr(B,A.attr(B));return k}),k=k[0],l=e(k)):(k=this,l=A,l.html(v));l.css({width:String(o)+"px",height:String(o)+"px",overflow:"hidden","background-size":String(o)+"px "+String(o)+
"px"});v=l.attr("id");v===""?(p=H+String(Math.random()).substring(2),l.attr("id",p),p="#"+p):e("#"+v).length!==1?(p=H+String(Math.random()).substring(2),l.addClass(p),p="."+p):p="#"+v;if(f!=="n"){if(f==="p")C=e("canvas:eq(0)",k),t=C[0],t.width=x,t.height=x*j,E=t.getContext("2d"),E.scale(h,h),C.css({width:String(o)+"px",height:String(o*j)+"px"});t=e("canvas:eq(1)",k);y=t[0];t.css("display","n");y.width=y.height=x;g=y.getContext("2d");g.lineWidth=b.lineWidth;g.lineCap=
b.lineCap;g.strokeStyle=b.color;if(b.shadow)g.shadowOffsetX=n,g.shadowOffsetY=u,g.shadowBlur=b.shadowBlur,g.shadowColor=b.shadowColor}else e.ajax({type:"GET",url:b.fallbackSourcesArray,dataType:"json",success:function(a){q=a;c=0;for(w=q.length;c<w;c+=1)e("<img />").attr("src",q[c])}});f==="f"&&e("canvas:eq(0)",k).remove();n=b.minimumOpacity;n<=0&&(n=1.0E-4);for(c=0;c<j;c+=1)h=2*Math.PI/j*c-Math.PI/2,u=Math.cos(h),h=Math.sin(h),z[c]=[b.innerRadius*u,b.innerRadius*h,s*u,s*h],D[c]=Math.pow(c/(j-1),
n*10)*(1-n)+n;F=Math.round(b.checkExistsInterval/i);s=function(){g.clearRect(0,0,x,x);D.unshift(D.pop());for(c=0;c<j;c+=1)g.globalAlpha=D[c],g.beginPath(),g.moveTo(m+z[c][0],m+z[c][1]),g.lineTo(m+z[c][2],m+z[c][3]),g.stroke();f==="f"?(q.push(y.toDataURL("image/png")),e("<img />").attr("src",q[q.length-1])):E.drawImage(y,0,r*o);r+=1};if(f!=="n"){for(;r<j;)s();r=0;t.remove()}l.data(H,{originalTarget:this,startAnimating:function(){var a=setInterval(function(){f==="p"?C.css("margin-top",
String(-1*r%j*o)+"px"):typeof q[r%j]!=="undefined"&&l.css({"background-image":"url("+q[r%j]+")"});r%F===0&&e(p).length!==1&&clearInterval(a);r+=1},i);return a},frames:q});b.autoStart===!0&&l.cSpinner("start");b.pauseOnBlur===!0&&e(window).bind("blur."+H,function(){l.cSpinner("stop")}).bind("focus."+H,function(){l.cSpinner("start")});k!==this&&(a[G]=k)});return a},start:function(){return this.each(function(){var d=e(this),a=d.data(H),f;a&&a.startAnimating&&!a.intervalID&&(f=a.startAnimating(),
d.data(H,{originalTarget:a.originalTarget,startAnimating:a.startAnimating,frames:a.frames,intervalID:f}))})},stop:function(){return this.each(function(){var d=e(this),a=d.data(H);a&&a.intervalID&&(clearInterval(a.intervalID),d.data(H,{originalTarget:a.originalTarget,startAnimating:a.startAnimating,frames:a.frames}))})},restore:function(){e(window).unbind("blur."+H).unbind("focus."+H);return this.each(function(){var d=e(this),a=d.data(H);a&&a.intervalID&&
clearInterval(a.intervalID);a&&a.originalTarget&&d.replaceWith(a.originalTarget)})},"export":function(){var d,a;return this.each(function(){var f=e(this).data(H),i;if(f&&f.frames){i="[";d=0;for(a=f.frames.length;d<a;d+=1)i+='"'+f.frames[d]+'"',d+1<a&&(i+=",");i+="]";e("body").text(i)}})}};e.fn.cSpinner=function(d){if(i[d])return i[d].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof d==="object"||!d)return i.init.apply(this,arguments);else e.error("jQuery."+H+": Method \u201c"+
d+"\u201d does not exist")}})(jQuery);