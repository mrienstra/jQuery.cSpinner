/*!
 * jQuery.cSpinner, v0.2.5
 * https://github.com/mrienstra/jQuery.cSpinner
 *
 * Copyright 2011, Michael Rienstra
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Based on code by Thijs van der Vossen, Fingertips, http://www.fngtps.com
 *
 * A jQuery plugin to create animated loading indicators using the canvas element
 *
 * Date: Wed Jul 6, 2011
 */
(function(e){var y={init:function(d){var b=this,n=function(){var b=document.createElement("canvas");return!(!b.getContext||!b.getContext("2d"))}();this.each(function(y){var a={speed:1,scale:1,lineWidth:3,lineCap:"round",innerRadius:8.7,outerRadius:14.42,color:"#000",minimumOpacity:0.18,segments:12,shadow:!1,shadowOffsetX:1,shadowOffsetY:1,shadowBlur:1,shadowColor:"rgba(10, 10, 10, 0.5)",pixelRatio:1,autoStart:!0,pauseOnBlur:!0,alwaysReplaceTarget:!1,fallbackSrc:void 0,checkExistsInterval:1E3,preserveExisting:["id",
"class","style"]},c,z,t=["lineWidth","innerRadius","outerRadius","shadowOffsetX","shadowOffsetY","shadowBlur"],h,E,i,j,o,p,g,q,k,r="<canvas /><canvas />",A=e(this),B,s,l,u,C,w,m,F,f,x=[],D=[],v=0,G;d&&e.extend(a,d);if(!n)if(typeof a.fallbackSrc==="undefined")return!0;else r="<img />";c=0;for(z=t.length;c<z;c+=1)a[t[c]]*=a.scale;h=a.segments;E=1E3/a.speed/h;t=a.outerRadius;i=t+a.lineWidth;if(a.shadow)j=a.shadowOffsetX,o=a.shadowOffsetY,i+=j>o?j:o,i+=a.shadowBlur;i=Math.ceil(i);p=q=i*2;g=a.pixelRatio;
g!==1&&(p*=g);a.alwaysReplaceTarget===!0||this.nodeName!=="DIV"?(k=e("<div>"+r+"</div>"),A.replaceWith(function(){c=0;for(z=a.preserveExisting.length;c<z;c+=1)B=a.preserveExisting[c],A.attr(B)&&k.attr(B,A.attr(B));return k}),k=k[0],s=e(k)):(k=this,s=A,s.html(r));s.css({overflow:"hidden",width:String(q)+"px",height:String(q)+"px"});r=s.attr("id");r===""?(m="cSpinner"+String(Math.random()).substring(2),s.attr("id",m),m="#"+m):e("#"+r).length!==1?(m="cSpinner"+String(Math.random()).substring(2),s.addClass(m),
m="."+m):m="#"+r;if(n){if(l=e("canvas:eq(0)",k),u=l[0],u.width=p,u.height=p*h,F=u.getContext("2d"),C=e("canvas:eq(1)",k),w=C[0],C.css("display","none"),w.width=w.height=p,f=w.getContext("2d"),f.lineWidth=a.lineWidth,f.lineCap=a.lineCap,f.strokeStyle=a.color,a.shadow)f.shadowOffsetX=j,f.shadowOffsetY=o,f.shadowBlur=a.shadowBlur,f.shadowColor=a.shadowColor}else l=e("img",k),l.attr("src",a.fallbackSrc);g!==1&&(n&&F.scale(g,g),l.css({width:String(q)+"px",height:String(q*h)+"px"}));j=a.minimumOpacity;
j<=0&&(j=1.0E-4);for(c=0;c<h;c+=1)g=2*Math.PI/h*c-Math.PI/2,o=Math.cos(g),g=Math.sin(g),x[c]=[a.innerRadius*o,a.innerRadius*g,t*o,t*g],D[c]=Math.pow(c/(h-1),j*10)*(1-j)+j;G=Math.round(a.checkExistsInterval/E);l.data("cSpinner",{originalTarget:this,startAnimating:function(){var a=setInterval(function(){if(n&&v<h){f.clearRect(0,0,p,p);D.unshift(D.pop());for(c=0;c<h;c+=1)f.globalAlpha=D[c],f.beginPath(),f.moveTo(i+x[c][0],i+x[c][1]),f.lineTo(i+x[c][2],i+x[c][3]),f.stroke();F.drawImage(w,0,v*q);v+1===
h&&C.remove()}l.css("margin-top",String(-1*v%h*q)+"px");v%G===0&&e(m).length!==1&&clearInterval(a);v+=1},E);return a}});a.autoStart===!0&&l.cSpinner("start");a.pauseOnBlur===!0&&e(window).blur(function(){l.cSpinner("stop")}).focus(function(){l.cSpinner("start")});u!==this&&(b[y]=u)});return b},start:function(){return this.each(function(){var d=e(this),b=d.data("cSpinner"),n;b&&b.startAnimating&&!b.intervalID&&(n=b.startAnimating(),d.data("cSpinner",{originalTarget:b.originalTarget,startAnimating:b.startAnimating,
intervalID:n}))})},stop:function(){return this.each(function(){var d=e(this),b=d.data("cSpinner");b&&b.intervalID&&(clearInterval(b.intervalID),d.data("cSpinner",{originalTarget:b.originalTarget,startAnimating:b.startAnimating}))})},restore:function(){return this.each(function(){var d=e(this),b=d.data("cSpinner");b&&b.intervalID&&clearInterval(b.intervalID);b&&b.originalTarget&&d.replaceWith(b.originalTarget)})}};e.fn.cSpinner=function(d){if(y[d])return y[d].apply(this,Array.prototype.slice.call(arguments,
1));else if(typeof d==="object"||!d)return y.init.apply(this,arguments);else e.error("jQuery.cSpinner: Method \u201c"+d+"\u201d does not exist")}})(jQuery);